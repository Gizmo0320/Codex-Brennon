import{d as $,a as n,B as V,c as i,q as D,b as t,t as d,f,T as R,_ as U,o as M,x as y,F as A,r as F,m as v,v as k,C as N,l as S,e as j,g as r}from"./index-DboNhKyU.js";const q={class:"dialog card"},O={class:"dialog-actions"},W=$({__name:"ConfirmDialog",props:{show:{type:Boolean},title:{},message:{}},emits:["confirm","cancel"],setup(b,{emit:w}){const o=w;return(p,u)=>(n(),V(R,{to:"body"},[b.show?(n(),i("div",{key:0,class:"overlay",onClick:u[2]||(u[2]=D(m=>o("cancel"),["self"]))},[t("div",q,[t("h3",null,d(b.title),1),t("p",null,d(b.message),1),t("div",O,[t("button",{onClick:u[0]||(u[0]=m=>o("cancel")),style:{background:"var(--bg-input)"}},"Cancel"),t("button",{class:"danger",onClick:u[1]||(u[1]=m=>o("confirm"))},"Confirm")])])])):f("",!0)]))}}),Y=U(W,[["__scopeId","data-v-5fe087a6"]]),_={class:"page-header"},z={style:{display:"flex",gap:"8px","align-items":"center"}},G=["disabled"],H={key:0,class:"lp-banner card"},J={key:1,class:"error-banner"},K={class:"card"},Q={key:0},X={key:0},Z=["onClick"],ee=["onClick"],te={class:"dialog card",style:{"min-width":"420px"}},le={key:0,class:"form-group"},se={class:"form-group"},ae={class:"form-group"},ne={class:"form-group"},ie={class:"form-group"},oe={style:{display:"flex",gap:"16px","margin-bottom":"16px"}},ue={style:{display:"flex",gap:"8px","justify-content":"flex-end"}},de=$({__name:"RanksView",setup(b){const w=r([]),o=r(!1),p=r(!1),u=r(!1),m=r(""),s=r({id:"",displayName:"",prefix:"",weight:0,permissions:"",isDefault:!1,isStaff:!1}),g=r(!1),x=r(!1),c=r("");M(async()=>{try{const a=await y.get("/modules");o.value=a.data.luckperms===!0}catch{}await C()});async function C(){const a=await y.get("/ranks");w.value=a.data}function h(){s.value={id:"",displayName:"",prefix:"",weight:0,permissions:"",isDefault:!1,isStaff:!1},g.value=!1,p.value=!0}function E(a){s.value={id:a.id,displayName:a.displayName,prefix:a.prefix,weight:a.weight,permissions:a.permissions.join(`
`),isDefault:a.isDefault,isStaff:a.isStaff},g.value=!0,p.value=!0}async function P(){const a={id:s.value.id,displayName:s.value.displayName,prefix:s.value.prefix,weight:s.value.weight,permissions:s.value.permissions.split(`
`).map(e=>e.trim()).filter(e=>e),isDefault:s.value.isDefault,isStaff:s.value.isStaff};g.value?await y.put(`/ranks/${a.id}`,a):await y.post("/ranks",a),p.value=!1,await C()}function B(a){m.value=a,u.value=!0}async function L(){await y.delete(`/ranks/${m.value}`),u.value=!1,await C()}async function T(){var a,e;x.value=!0,c.value="";try{const l=await y.post("/luckperms/editor");l.data.url&&window.open(l.data.url,"_blank")}catch(l){c.value=((e=(a=l.response)==null?void 0:a.data)==null?void 0:e.error)||"Failed to open editor"}x.value=!1}return(a,e)=>(n(),i("div",null,[t("div",_,[e[10]||(e[10]=t("h1",null,"Ranks",-1)),t("div",z,[o.value?(n(),i("button",{key:0,onClick:T,disabled:x.value},d(x.value?"Opening...":"Open LuckPerms Editor"),9,G)):f("",!0),o.value?f("",!0):(n(),i("button",{key:1,onClick:h},"Create Rank"))])]),o.value?(n(),i("div",H," Permissions are managed by LuckPerms. Use the web editor to make changes. Ranks shown below are synced from LuckPerms and are read-only. ")):f("",!0),c.value?(n(),i("div",J,d(c.value),1)):f("",!0),t("div",K,[t("table",null,[t("thead",null,[t("tr",null,[e[11]||(e[11]=t("th",null,"ID",-1)),e[12]||(e[12]=t("th",null,"Name",-1)),e[13]||(e[13]=t("th",null,"Prefix",-1)),e[14]||(e[14]=t("th",null,"Weight",-1)),e[15]||(e[15]=t("th",null,"Staff",-1)),e[16]||(e[16]=t("th",null,"Default",-1)),o.value?f("",!0):(n(),i("th",Q,"Actions"))])]),t("tbody",null,[(n(!0),i(A,null,F(w.value,l=>(n(),i("tr",{key:l.id},[t("td",null,d(l.id),1),t("td",null,d(l.displayName),1),t("td",null,d(l.prefix),1),t("td",null,d(l.weight),1),t("td",null,d(l.isStaff?"Yes":"No"),1),t("td",null,d(l.isDefault?"Yes":"No"),1),o.value?f("",!0):(n(),i("td",X,[t("button",{onClick:I=>E(l),style:{"margin-right":"4px"}},"Edit",8,Z),t("button",{class:"danger",onClick:I=>B(l.id)},"Delete",8,ee)]))]))),128))])])]),(n(),V(R,{to:"body"},[p.value&&!o.value?(n(),i("div",{key:0,class:"overlay",onClick:e[8]||(e[8]=D(l=>p.value=!1,["self"]))},[t("div",te,[t("h3",null,d(g.value?"Edit Rank":"Create Rank"),1),t("form",{onSubmit:D(P,["prevent"])},[g.value?f("",!0):(n(),i("div",le,[e[17]||(e[17]=t("label",null,"ID",-1)),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.id=l),required:""},null,512),[[k,s.value.id]])])),t("div",se,[e[18]||(e[18]=t("label",null,"Display Name",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.displayName=l)},null,512),[[k,s.value.displayName]])]),t("div",ae,[e[19]||(e[19]=t("label",null,"Prefix",-1)),v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.prefix=l)},null,512),[[k,s.value.prefix]])]),t("div",ne,[e[20]||(e[20]=t("label",null,"Weight",-1)),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.weight=l),type:"number"},null,512),[[k,s.value.weight,void 0,{number:!0}]])]),t("div",ie,[e[21]||(e[21]=t("label",null,"Permissions (one per line)",-1)),v(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.permissions=l),rows:"4"},null,512),[[k,s.value.permissions]])]),t("div",oe,[t("label",null,[v(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>s.value.isDefault=l)},null,512),[[N,s.value.isDefault]]),e[22]||(e[22]=S(" Default",-1))]),t("label",null,[v(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=l=>s.value.isStaff=l)},null,512),[[N,s.value.isStaff]]),e[23]||(e[23]=S(" Staff",-1))])]),t("div",ue,[t("button",{type:"button",onClick:e[7]||(e[7]=l=>p.value=!1),style:{background:"var(--bg-input)"}},"Cancel"),e[24]||(e[24]=t("button",{type:"submit"},"Save",-1))])],32)])])):f("",!0)])),j(Y,{show:u.value,title:"Delete Rank",message:`Are you sure you want to delete rank '${m.value}'?`,onConfirm:L,onCancel:e[9]||(e[9]=l=>u.value=!1)},null,8,["show","message"])]))}}),fe=U(de,[["__scopeId","data-v-fc857dde"]]);export{fe as default};

import{d as B,l as D,j as f,o,c as n,a as e,f as m,g as b,F as k,n as j,t as i,q as N,A as $,e as c,b as _,v as x,x as E,w as F,T as U,r as v,h as z,i as C,_ as I}from"./index-DUiR62IA.js";const L={class:"portal"},R={class:"portal-nav"},O={class:"portal-links"},q={class:"portal-content"},A={class:"page-header"},G={class:"card"},H=["onClick"],J={style:{"font-family":"monospace"}},K={key:0},Q={class:"page-header"},W={class:"card"},X={style:{"margin-top":"8px",display:"flex",gap:"16px",color:"var(--text-secondary)","font-size":"13px"}},Y={key:0},Z={class:"card"},ee={class:"msg-header"},te={key:0,class:"badge online",style:{"margin-left":"8px"}},se={style:{color:"var(--text-secondary)","margin-left":"auto","font-size":"12px"}},le={class:"msg-content"},ae={key:0,style:{color:"var(--text-secondary)","text-align":"center",padding:"12px"}},oe={key:0,class:"card"},ne=["disabled"],ie={class:"dialog card"},re={class:"form-group"},ue={class:"form-group"},de={style:{display:"flex","justify-content":"flex-end",gap:"8px"}},ce=["disabled"],ve=B({__name:"PlayerTicketsView",setup(pe){const g=v([]),l=v(null),p=v(!1),r=v({subject:"",description:""}),y=v(""),u=v(!1);D(w);async function w(){const a=await f.get("/player/tickets");g.value=a.data}async function T(a){const t=await f.get(`/player/tickets/${a}`);l.value=t.data}async function M(){var a,t;if(!r.value.subject.trim()){alert("Subject is required");return}u.value=!0;try{await f.post("/player/tickets",r.value),p.value=!1,r.value={subject:"",description:""},await w()}catch(d){alert(((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to create ticket")}u.value=!1}async function P(){var a,t;if(!(!y.value.trim()||!l.value)){u.value=!0;try{await f.post(`/player/tickets/${l.value.id}/reply`,{content:y.value}),y.value="",await T(l.value.id)}catch(d){alert(((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to send reply")}u.value=!1}}function V(a){return a==="HIGH"||a==="URGENT"?"var(--danger)":a==="MEDIUM"?"var(--warning)":"var(--text-secondary)"}return(a,t)=>{var h;const d=z("router-link");return o(),n("div",L,[e("div",R,[t[10]||(t[10]=e("div",{class:"portal-brand"},[e("h2",null,"Brennon"),e("span",{class:"version"},"Player Portal")],-1)),e("div",O,[m(d,{to:"/portal",class:"nav-link"},{default:b(()=>[...t[7]||(t[7]=[C("Profile",-1)])]),_:1}),m(d,{to:"/portal/appeals",class:"nav-link"},{default:b(()=>[...t[8]||(t[8]=[C("Appeals",-1)])]),_:1}),m(d,{to:"/portal/tickets",class:"nav-link","active-class":"active"},{default:b(()=>[...t[9]||(t[9]=[C("Tickets",-1)])]),_:1})])]),e("div",q,[l.value?(o(),n(k,{key:1},[e("div",Q,[e("h1",null,"Ticket "+i(l.value.id),1),e("button",{style:{background:"var(--bg-input)"},onClick:t[1]||(t[1]=s=>l.value=null)},"Back to List")]),e("div",W,[e("h2",null,i(l.value.subject),1),e("div",X,[e("span",null,"Status: "+i(l.value.status),1),e("span",null,"Priority: "+i(l.value.priority),1),l.value.server?(o(),n("span",Y,"Server: "+i(l.value.server),1)):c("",!0)])]),e("div",Z,[t[14]||(t[14]=e("h3",{style:{"margin-bottom":"12px"}},"Messages",-1)),(o(!0),n(k,null,j(l.value.messages,(s,S)=>(o(),n("div",{key:S,class:N(["message",{staff:s.isStaffMessage}])},[e("div",ee,[e("strong",null,i(s.authorName),1),s.isStaffMessage?(o(),n("span",te,"Staff")):c("",!0),e("span",se,i(s.timestamp),1)]),e("div",le,i(s.content),1)],2))),128)),(h=l.value.messages)!=null&&h.length?c("",!0):(o(),n("div",ae," No messages yet "))]),l.value.status!=="CLOSED"?(o(),n("div",oe,[t[15]||(t[15]=e("h3",{style:{"margin-bottom":"8px"}},"Reply",-1)),_(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),rows:"3",placeholder:"Type your reply..."},null,512),[[x,y.value]]),e("button",{onClick:P,disabled:u.value,style:{"margin-top":"8px"}},"Send Reply",8,ne)])):c("",!0)],64)):(o(),n(k,{key:0},[e("div",A,[t[11]||(t[11]=e("h1",null,"My Tickets",-1)),e("button",{onClick:t[0]||(t[0]=s=>p.value=!0)},"New Ticket")]),e("div",G,[e("table",null,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Subject"),e("th",null,"Status"),e("th",null,"Priority")])],-1)),e("tbody",null,[(o(!0),n(k,null,j(g.value,s=>(o(),n("tr",{key:s.id,onClick:S=>T(s.id),style:{cursor:"pointer"}},[e("td",J,i(s.id),1),e("td",null,i(s.subject),1),e("td",null,[e("span",{class:N(["badge",s.status==="OPEN"?"online":s.status==="CLOSED"?"offline":"pending"])},i(s.status),3)]),e("td",{style:$({color:V(s.priority)})},i(s.priority),5)],8,H))),128)),g.value.length===0?(o(),n("tr",K,[...t[12]||(t[12]=[e("td",{colspan:"4",style:{"text-align":"center",color:"var(--text-secondary)"}}," No tickets yet ",-1)])])):c("",!0)])])])],64)),(o(),E(U,{to:"body"},[p.value?(o(),n("div",{key:0,class:"overlay",onClick:t[6]||(t[6]=F(s=>p.value=!1,["self"]))},[e("div",ie,[t[18]||(t[18]=e("h2",{style:{"margin-bottom":"16px"}},"Create Ticket",-1)),e("div",re,[t[16]||(t[16]=e("label",null,"Subject",-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.subject=s),placeholder:"Brief description of your issue"},null,512),[[x,r.value.subject]])]),e("div",ue,[t[17]||(t[17]=e("label",null,"Description",-1)),_(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.description=s),rows:"4",placeholder:"Provide details about your issue..."},null,512),[[x,r.value.description]])]),e("div",de,[e("button",{style:{background:"var(--bg-input)"},onClick:t[5]||(t[5]=s=>p.value=!1)},"Cancel"),e("button",{disabled:u.value,onClick:M},i(u.value?"Creating...":"Create Ticket"),9,ce)])])])):c("",!0)]))])])}}}),fe=I(ve,[["__scopeId","data-v-9d290a5d"]]);export{fe as default};

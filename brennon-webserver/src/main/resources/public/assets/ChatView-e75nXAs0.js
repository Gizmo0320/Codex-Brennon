import{d as k,l as x,j as _,k as g,m as w,C as b,o as n,c as t,a as e,F as f,n as y,A as T,t as c,e as D,b as N,v as V,p as I,r as i,_ as M}from"./index-DUiR62IA.js";const S={class:"card",style:{"margin-bottom":"16px"}},B={style:{display:"flex",gap:"8px"}},U=["onClick"],F={class:"card chat-box"},K={class:"msg-time"},L={class:"msg-channel"},j={class:"msg-sender"},z={class:"msg-text"},A={key:0,style:{color:"var(--text-secondary)","text-align":"center",padding:"40px"}},E={class:"chat-input"},H=k({__name:"ChatView",setup(W){const m=i([]),u=i("global"),o=i([]),l=i(""),r=i(null);x(async()=>{const s=await _.get("/chat/channels");m.value=s.data,g.on("chat_message",h)}),w(()=>{g.off("chat_message",h)});function h(s){o.value.push({sender:s.senderName||s.sender||"Unknown",channel:s.channelId||s.channel||"?",message:s.message||s.content||"",timestamp:Date.now()}),o.value.length>200&&o.value.shift(),b(()=>{r.value&&(r.value.scrollTop=r.value.scrollHeight)})}async function p(){l.value.trim()&&(await _.post("/chat/send",{sender:"00000000-0000-0000-0000-000000000000",senderName:"Dashboard",channelId:u.value,message:l.value}),l.value="")}function C(s){return new Date(s).toLocaleTimeString()}return(s,d)=>(n(),t("div",null,[d[1]||(d[1]=e("div",{class:"page-header"},[e("h1",null,"Chat")],-1)),e("div",S,[e("div",B,[(n(!0),t(f,null,y(m.value,a=>(n(),t("button",{key:a.id,onClick:v=>u.value=a.id,style:T({background:u.value===a.id?"var(--accent)":"var(--bg-input)"})},c(a.displayName),13,U))),128))])]),e("div",F,[e("div",{ref_key:"chatContainer",ref:r,class:"messages"},[(n(!0),t(f,null,y(o.value,(a,v)=>(n(),t("div",{key:v,class:"chat-msg"},[e("span",K,c(C(a.timestamp)),1),e("span",L,"["+c(a.channel)+"]",1),e("span",j,c(a.sender),1),e("span",z,c(a.message),1)]))),128)),o.value.length===0?(n(),t("div",A," Waiting for messages... ")):D("",!0)],512),e("div",E,[N(e("input",{"onUpdate:modelValue":d[0]||(d[0]=a=>l.value=a),placeholder:"Type a message...",onKeyup:I(p,["enter"])},null,544),[[V,l.value]]),e("button",{onClick:p},"Send")])])]))}}),q=M(H,[["__scopeId","data-v-00c88e80"]]);export{q as default};

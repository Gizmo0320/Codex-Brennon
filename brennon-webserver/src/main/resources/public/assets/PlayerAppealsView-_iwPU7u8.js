import{d as S,o as D,x as f,a as n,c as i,b as t,e as c,w as y,f as b,F as k,r as x,t as o,n as I,B as V,q as N,m as w,D as R,v as B,T as M,u as T,g as d,i as E,l as g,_ as F}from"./index-DboNhKyU.js";const L={class:"portal"},$={class:"portal-nav"},q={class:"portal-links"},z={class:"portal-content"},U={class:"page-header"},j={class:"card"},G={style:{"font-family":"monospace","font-size":"12px"}},O={key:0},W={class:"dialog card"},H={class:"form-group"},J=["value"],K={class:"form-group"},Q={style:{display:"flex","justify-content":"flex-end",gap:"8px"}},X=["disabled"],Y=S({__name:"PlayerAppealsView",setup(Z){const _=T(),v=d([]),m=d([]),r=d(!1),l=d({punishmentId:"",reason:""}),p=d(!1);D(async()=>{await h();const a=_.query.punishmentId;a&&(l.value.punishmentId=a,r.value=!0)});async function h(){const[a,e]=await Promise.all([f.get("/appeals/mine"),f.get("/player/punishments").catch(()=>({data:[]}))]);v.value=a.data,m.value=e.data}async function P(){var a,e;if(!l.value.punishmentId||!l.value.reason.trim()){alert("Please select a punishment and provide a reason");return}p.value=!0;try{await f.post("/appeals",l.value),r.value=!1,l.value={punishmentId:"",reason:""},await h()}catch(u){alert(((e=(a=u.response)==null?void 0:a.data)==null?void 0:e.error)||"Failed to submit appeal")}p.value=!1}function C(a){return new Date(a).toLocaleString()}function A(a){return a==="PENDING"?"pending":a==="APPROVED"?"online":"offline"}return(a,e)=>{const u=E("router-link");return n(),i("div",L,[t("div",$,[e[8]||(e[8]=t("div",{class:"portal-brand"},[t("h2",null,"Brennon"),t("span",{class:"version"},"Player Portal")],-1)),t("div",q,[c(u,{to:"/portal",class:"nav-link"},{default:y(()=>[...e[5]||(e[5]=[g("Profile",-1)])]),_:1}),c(u,{to:"/portal/appeals",class:"nav-link","active-class":"active"},{default:y(()=>[...e[6]||(e[6]=[g("Appeals",-1)])]),_:1}),c(u,{to:"/portal/tickets",class:"nav-link"},{default:y(()=>[...e[7]||(e[7]=[g("Tickets",-1)])]),_:1})])]),t("div",z,[t("div",U,[e[9]||(e[9]=t("h1",null,"My Appeals",-1)),m.value.length>0?(n(),i("button",{key:0,onClick:e[0]||(e[0]=s=>r.value=!0)},"New Appeal")):b("",!0)]),t("div",j,[t("table",null,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"Punishment"),t("th",null,"Reason"),t("th",null,"Status"),t("th",null,"Submitted"),t("th",null,"Staff Response")])],-1)),t("tbody",null,[(n(!0),i(k,null,x(v.value,s=>(n(),i("tr",{key:s.id},[t("td",G,o(s.punishmentId.substring(0,8))+"...",1),t("td",null,o(s.reason.length>40?s.reason.substring(0,40)+"...":s.reason),1),t("td",null,[t("span",{class:I(["badge",A(s.status)])},o(s.status),3)]),t("td",null,o(C(s.createdAt)),1),t("td",null,o(s.staffResponse||"-"),1)]))),128)),v.value.length===0?(n(),i("tr",O,[...e[10]||(e[10]=[t("td",{colspan:"5",style:{"text-align":"center",color:"var(--text-secondary)"}}," No appeals submitted ",-1)])])):b("",!0)])])]),(n(),V(M,{to:"body"},[r.value?(n(),i("div",{key:0,class:"overlay",onClick:e[4]||(e[4]=N(s=>r.value=!1,["self"]))},[t("div",W,[e[15]||(e[15]=t("h2",{style:{"margin-bottom":"16px"}},"Submit Appeal",-1)),t("div",H,[e[13]||(e[13]=t("label",null,"Punishment",-1)),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.punishmentId=s)},[e[12]||(e[12]=t("option",{value:"",disabled:""},"Select a punishment...",-1)),(n(!0),i(k,null,x(m.value,s=>(n(),i("option",{key:s.id,value:s.id},o(s.type)+" - "+o(s.reason)+" ("+o(s.isPermanent?"Permanent":new Date(s.expiresAt).toLocaleDateString())+") ",9,J))),128))],512),[[R,l.value.punishmentId]])]),t("div",K,[e[14]||(e[14]=t("label",null,"Why should this be appealed?",-1)),w(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.reason=s),rows:"5",placeholder:"Explain why you believe this punishment should be reversed..."},null,512),[[B,l.value.reason]])]),t("div",Q,[t("button",{style:{background:"var(--bg-input)"},onClick:e[3]||(e[3]=s=>r.value=!1)},"Cancel"),t("button",{disabled:p.value,onClick:P},o(p.value?"Submitting...":"Submit Appeal"),9,X)])])])):b("",!0)]))])])}}}),te=F(Y,[["__scopeId","data-v-28f110b7"]]);export{te as default};
